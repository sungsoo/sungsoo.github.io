---
layout: post
title: Graphs for Causal AI
date: 2025-08-06
categories: [artificial intelligence]
tags: [artificial general intelligence]

---

# [Graphs for Causal AI](https://notebooklm.google.com/notebook/036594e3-13f8-46df-b6d0-417f259a054d?artifactId=c869ede0-b647-40dc-9659-1d7636702e31)


## 그래프 및 네트워크를 활용한 인과 AI

### 1. 네트워크 과학의 실제 적용 사례: 교황 예측

*   **배경**: 교황 선출 하루 전, 이탈리아 보코니 대학교의 연구팀이 추기경 네트워크, 즉 '바티칸 네트워크'를 발표했습니다.
*   **데이터 출처**: 이 네트워크는 세 가지 주요 정보를 사용했습니다:
    *   **서임 관계**: 누가 누구를 서임했는지 (일종의 후원 시스템).
    *   **교회 기관의 공식 공동 멤버십**.
    *   **비공식적 관계**: 기사 등에 언급된 내용.
*   **추기경의 중요도 측정 기준**:
    *   **위상(Status)**: **고유벡터 중심성(eigenvector centrality)**을 사용하여 측정. 높은 연결성을 가진 노드의 이웃에 있으면 높은 점수를 받습니다.
    *   **정보 통제(Information control)**: **매개 중심성(betweenness centrality)**을 사용하여 측정. 네트워크의 여러 부분 간 다리 역할을 하는 정도를 나타냅니다.
    *   **연합 형성 능력(Ability to build coalitions)**: **지역 군집 계수(local clustering coefficient)**를 사용하여 측정. 특정 노드 주변에서 얼마나 많은 트라이어드(세 노드 간의 폐쇄된 연결)가 형성되는지를 나타냅니다.
*   **예측 결과**: 이 연구에 따르면 **로버트 프리보스트(Robert Prevost)**, 즉 레오 14세가 네트워크에서 가장 높은 고유벡터 중심성을 가졌습니다.
*   **의미**: 이 예측은 성공했기 때문에 큰 주목을 받았으며, 만약 실패했다면 다른 많은 예측들과 마찬가지로 알려지지 않았을 것입니다.

### 2. 지식 그래프와 인과성

*   **지식 그래프의 본질**: 지식 그래프는 본질적으로 불완전하며, 항상 누락된 링크가 존재합니다. 모든 지식의 전체 범위를 알 수는 없습니다.
*   **AI의 한계: 상관관계 vs. 인과성**:
    *   통계는 상관관계를 찾는 데 뛰어나지만, **인과 관계**를 밝히는 데는 한계가 있습니다.
    *   **허위 상관관계(spurious correlations)**의 예시로 아이스크림 판매 증가와 익사자 수 증가가 있습니다. 통계는 이러한 관계를 보여주지만, 실제 원인은 아니며(예: 여름이라는 공통 원인), 인과성을 이해해야 합니다.
    *   **안전 필수 AI 애플리케이션의 중요성**: 헬스케어, 산업 제조, 자율주행 등 생명과 직결된 분야에서는 단순한 상관관계에 의존하는 것이 아니라, 인과성을 기반으로 올바른 결정을 내려야 합니다. 잘못된 판단은 인명 피해로 이어질 수 있습니다.

### 3. 인과 신경-기호 AI (Causal Neurosymbolic AI)

*   **개념**: AI를 사람들에게 더 설명 가능하게 만들고, AI 시스템이 인간과 같은 인과적 이해 또는 추론을 배우도록 하는 것을 목표로 합니다.
*   **신경-기호(Neurosymbolic)의 정의**:
    *   **기호적(Symbolic) 부분**: 지식 그래프를 사용하여 모든 것을 트리플(예: A causes B) 형태로 표현합니다. RDF(Resource Description Framework) 또는 설명 논리(description logic) 기반의 트리플 지식 그래프를 사용합니다.
    *   **신경(Neuro) 부분**: 이 지식 그래프를 벡터 공간 또는 임베딩 공간으로 변환합니다. 모든 노드와 관계는 벡터로 표현됩니다.
    *   **결합**: 이 두 부분을 결합하여 신경-기호 AI를 형성합니다.
*   **응용**: 변환된 지식 그래프는 링크 예측, 클러스터링, 노드 분류와 같은 다양한 AI 작업에 사용될 수 있습니다.
*   **임베딩의 유사성**: 텍스트 임베딩(예: "왕-남자+여자=여왕"과 같은 속성)과 유사하게, 지식 그래프 임베딩에서도 유사한 거리 기반 메트릭을 사용할 수 있습니다. 현재는 기성 방법이 많지만, 인과 효과를 임베딩 공간에 직접 통합하는 연구가 진행 중입니다.

### 4. 인과성의 핵심 개념

*   **Do-calculus**: 인과성을 검토하기 위한 확립된 방법론 중 하나입니다.
*   **개입(Intervention) 및 효과 측정**: 특정 변수에 대한 개입의 효과를 측정하는 데 사용됩니다.
    *   **총 인과 효과(Total causal effect)**: 치료 변수에 대한 개입이 결과 변수에 미치는 영향을 추정합니다.
    *   **매개변수(Mediator) 관련 효과**: A가 B를 유발하고 B가 C를 유발하는 직렬 체인에서 B가 매개변수일 때, B의 효과가 A에서 C로의 인과 관계에 어떻게 영향을 미치는지 추정하는 **인과 직접 효과(causal direct effect)**와 **인과 간접 효과(causal indirect effects)**가 있습니다.
*   **백도어 경로(Backdoor Path)**:
    *   **정의**: 인과 변수와 그 결과 변수를 연결하는 **비인과적 경로**입니다.
    *   **공통 원인/교란 변수(Confounder)**: A와 B 모두에 영향을 미치는 공통 변수 D가 있을 때, D는 백도어 경로를 형성하여 A와 B 사이의 관계를 왜곡할 수 있습니다.
    *   **문제점**: 백도어 경로는 **허위 상관관계**로 이어져 인과 관계에 대한 잘못된 결론을 내리게 할 수 있습니다.
    *   **예시**: **흡연과 폐암**: 흡연 유전자는 흡연과 폐암 모두의 원인이 될 수 있습니다. 흡연이 폐암을 유발하는 관계를 볼 때, 흡연 유전자의 맥락을 고려하지 않으면 흡연이 항상 폐암의 원인이라고 잘못 판단할 수 있습니다.
    *   **학습 가능성**: 백도어 경로는 **인과 구조 학습 알고리즘**을 통해 학습될 수 있으며, 의료 전문가가 환자의 나이와 같은 맥락적 요인을 고려하는 것과 같이 주어진 맥락을 통해서도 알 수 있습니다.
*   **마르코프 베이스 스플릿(Markov Base Split)**:
    *   **목적**: 인과 네트워크를 분할할 때 **데이터 누수(data leakage)**를 방지하는 방법입니다.
    *   **데이터 누수 발생**: 무작위로 데이터를 분할하면, 테스트 세트의 일부 노드가 훈련 세트에 이미 포함된 링크를 가질 수 있어 편향된 결과를 초래할 수 있습니다.
    *   **영향**: 마르코프 베이스 스플릿을 포함하지 않으면, 링크 예측에서 **평균 상호 순위(Mean Reciprocal Rank, MRR)** 점수가 42.3% 증가하여 편향이 있음을 보여줍니다.

### 5. Causal LP-back 아키텍처

*   **동기**: 소아 천식 환자 연구 중 환경 매개변수(예: 꽃가루)와 천식 발작 간의 상관관계를 넘어 실제 원인을 파악하는 데서 영감을 받았습니다. 무작위 대조 시험은 현실적으로 불가능하며, 지식 그래프가 의사의 전문 지식을 보완할 수 있다고 보았습니다.
*   **목표**: 인과 베이지안 네트워크의 개념을 신경-기호 AI 공간, 즉 지식 그래프에 통합하여 **인과 관계 예측**을 수행하는 포괄적인 프레임워크를 만드는 것입니다. 특히, **백도어 경로의 영향을 제거**하면서 링크 예측을 수행하는 것을 목표로 합니다.
*   **주요 방법론**:
    *   **인과 온톨로지(Causal Ontology) 생성**: 베이지안 네트워크에서 신경-기호 AI 공간으로 구조와 개념(예: 가중치)을 일대일로 매핑하여 인과성을 표현합니다.
    *   **가중치 통합**: 인과 관계의 강도(예: 아스피린이 두통을 얼마나 치료하는지)를 나타내는 가중치를 임베딩 공간에 직접 통합하거나 손실 함수에 적용하는 방법을 연구합니다.
    *   **매개변수(Mediator) 고려**: A가 B를 유발하고 B가 C를 유발할 때 B와 같은 매개변수를 고려하며, 이를 위해 **하이퍼-관계형 그래프(hyper-relational graphs)**를 사용합니다. 매개변수를 고려할 때 링크 예측 작업에서 상당한 개선을 보였습니다.
    *   **백도어 경로 처리**: 링크 예측 작업 시 백도어 경로의 영향을 제거합니다.
    *   **인과 발견 문제의 전환**: 관찰 데이터를 통해 인과 네트워크를 학습하는 '인과 발견(causal discovery)' 문제를 신경-기호 AI 공간에서의 '인과 링크 예측(causal link prediction)' 문제로 전환했습니다.
    *   **점진적 접근**: 기존 알고리즘으로 학습되거나 전문가가 제공한 초기 인과 네트워크를 지식 그래프 공간에 매핑한 후, 지식 그래프 기술을 사용하여 새로운 인과 링크를 학습합니다.
*   **평가 지표**: **평균 상호 순위(Mean Reciprocal Rank, MRR)**와 **Hits@K (Hits@1, 3, 5, 10)**를 사용합니다.
*   **벤치마크 데이터셋**:
    *   **Clever Humans**: 시각적 인과 추론 벤치마크 데이터셋(충돌하는 객체 비디오)을 인과 지식 그래프로 변환하여 사용합니다.
    *   다른 텍스트 기반 인과 지식 그래프(WikiCausal, CosNet 등)와는 접근 방식(인과 네트워크 vs. 텍스트)이 다르기 때문에 직접적인 비교는 어렵습니다.

### 6. 응용 분야 및 설명 가능한 AI

*   **주요 응용 분야**:
    *   **헬스케어**: 특정 질병이나 증상의 원인 파악.
    *   **스마트 제조**: 조립 라인 이상(예: 누락된 부품)의 근본 원인 분석.
    *   **자율주행**: 자율 주행 차량이 취한 행동에 대한 추론.
*   **설명 가능한 AI(Explainable AI, XAI)에 기여**:
    *   지식 그래프는 인간에게 본질적으로 **설명 가능(explainable)**합니다.
    *   링크 예측 알고리즘이나 신경망이 특정 결과를 도출한 이유를 설명하기 위해 지식 그래프 내의 노드와 경로를 추적할 수 있습니다.

