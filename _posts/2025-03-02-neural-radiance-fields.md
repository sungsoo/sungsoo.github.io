---
layout: post
title: Neural Radiance Fields
date: 2025-03-02
categories: [artificial intelligence]
tags: [machine learning]

---

# Neural Radiance Fields


Neural Radiance Fields(NeRF)는 3D 장면을 연속적인 함수로 표현해서 임의의 시점에서 사진처럼 현실적인 이미지를 생성하는 기술이다. NeRF는 특정 장면을 명시적인 3D 모델(예: 메쉬나 포인트 클라우드) 대신, 심층 신경망에 내재된 함수로 나타낸다.

---

## 기본 개념

NeRF는 5차원 좌표를 입력받아 해당 위치에서의 색상과 밀도를 출력하는 함수로 생각할 수 있다. 이 5차원 좌표는 공간상의 3D 좌표(x, y, z)와 시점을 결정하는 2D 방향(예: unit vector)으로 구성된다. 함수 f는 다음과 같이 정의된다.

- f(x, y, z, θ, φ) → (RGB 색상, 밀도)

여기서 밀도는 해당 위치에서 광선이 얼마나 흡수되는지를 결정하며, RGB 색상은 빛이 해당 방향으로 방출되는 색을 나타낸다.

---

## 학습 및 렌더링 과정

1. **데이터 수집**  
   여러 시점에서 촬영된 이미지와 그에 해당하는 카메라 위치 및 방향 정보가 주어진다.

2. **신경망 학습**  
   신경망은 입력된 5차원 좌표에 대해 출력되는 색상과 밀도를 예측하도록 학습된다. 이때, 렌더링 방정식을 통해 실제 이미지와 신경망이 예측한 이미지 사이의 차이를 최소화하는 방식으로 최적화가 이루어진다.

3. **볼륨 렌더링**  
   각 픽셀에 대응하는 광선을 장면에 투사한 뒤, 광선이 통과하는 경로를 따라 여러 점의 색상과 밀도를 계산하고 이들을 적분해 최종 픽셀 색상을 결정한다. 즉, 픽셀의 색상은 해당 광선이 만나는 모든 점의 기여도를 합산한 결과이다.

4. **위치 인코딩(Positional Encoding)**  
   일반적인 신경망은 고주파 정보를 잘 포착하지 못하기 때문에, 좌표 값을 주기 함수(예: 사인, 코사인)와 같은 함수를 이용해 고차원 특징으로 변환하는 기법을 사용한다. 이로 인해 미세한 세부 정보까지 효과적으로 표현할 수 있다.

---

## 장점과 응용

- **사진 수준의 합성**  
  적은 수의 입력 이미지로부터 장면의 전체 3D 구조와 복잡한 조명 효과까지 포착하여 새로운 시점에서의 이미지를 고품질로 생성할 수 있다.
  
- **암시적 3D 표현**  
  명시적인 3D 모델 대신 신경망 내부에 장면 정보를 암시적으로 저장하므로, 복잡한 지오메트리나 재질을 효율적으로 표현할 수 있다.

- **응용 분야**  
  가상현실, 증강현실, 영화 제작, 게임 등에서 3D 장면 재구성 및 새로운 시점의 이미지 합성에 활용된다.

---

## 한계점

- **연산 비용**  
  학습과 렌더링 과정에서 수많은 광선에 대해 여러 번의 함수 평가가 필요해 계산 비용이 매우 크다.
  
- **장면 특화**  
  보통 하나의 장면에 대해 모델을 따로 학습해야 하므로, 다양한 장면에 대해 실시간으로 적용하기에는 한계가 있다.
  
- **데이터 요구량**  
  고품질의 합성을 위해서는 다양한 시점에서 촬영된 이미지가 필요하며, 입력 데이터가 부족하면 성능이 떨어질 수 있다.

---

Neural Radiance Fields는 신경망을 이용해 장면의 모든 정보를 암시적으로 표현하고, 이를 기반으로 임의의 시점에서 현실적인 이미지를 생성하는 혁신적인 기술이다. 이 기술은 3D 재구성 및 새로운 시점의 이미지 합성 분야에서 많은 가능성을 보여주고 있으며, 앞으로의 연구와 응용에서 중요한 역할을 할 것으로 기대된다.