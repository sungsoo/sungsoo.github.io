---
layout: post
title: Neural Radiance Fields
date: 2025-03-02
categories: [artificial intelligence]
tags: [machine learning]

---

# Neural Radiance Fields


Neural Radiance Fields(NeRF)는 3D 장면을 연속적인 함수로 표현해서 임의의 시점에서 사진처럼 현실적인 이미지를 생성하는 기술이다. NeRF는 특정 장면을 명시적인 3D 모델(예: 메쉬나 포인트 클라우드) 대신, 심층 신경망에 내재된 함수로 나타낸다.

---

## 기본 개념

NeRF는 5차원 좌표를 입력받아 해당 위치에서의 색상과 밀도를 출력하는 함수로 생각할 수 있다. 이 5차원 좌표는 공간상의 3D 좌표(x, y, z)와 시점을 결정하는 2D 방향(예: unit vector)으로 구성된다. 함수 f는 다음과 같이 정의된다.

- f(x, y, z, θ, φ) → (RGB 색상, 밀도)

여기서 밀도는 해당 위치에서 광선이 얼마나 흡수되는지를 결정하며, RGB 색상은 빛이 해당 방향으로 방출되는 색을 나타낸다.

---

## 학습 및 렌더링 과정

1. **데이터 수집**  
   여러 시점에서 촬영된 이미지와 그에 해당하는 카메라 위치 및 방향 정보가 주어진다.

2. **신경망 학습**  
   신경망은 입력된 5차원 좌표에 대해 출력되는 색상과 밀도를 예측하도록 학습된다. 이때, 렌더링 방정식을 통해 실제 이미지와 신경망이 예측한 이미지 사이의 차이를 최소화하는 방식으로 최적화가 이루어진다.

3. **볼륨 렌더링**  
   각 픽셀에 대응하는 광선을 장면에 투사한 뒤, 광선이 통과하는 경로를 따라 여러 점의 색상과 밀도를 계산하고 이들을 적분해 최종 픽셀 색상을 결정한다. 즉, 픽셀의 색상은 해당 광선이 만나는 모든 점의 기여도를 합산한 결과이다.

4. **위치 인코딩(Positional Encoding)**  
   일반적인 신경망은 고주파 정보를 잘 포착하지 못하기 때문에, 좌표 값을 주기 함수(예: 사인, 코사인)와 같은 함수를 이용해 고차원 특징으로 변환하는 기법을 사용한다. 이로 인해 미세한 세부 정보까지 효과적으로 표현할 수 있다.

---

## 장점과 응용

- **사진 수준의 합성**  
  적은 수의 입력 이미지로부터 장면의 전체 3D 구조와 복잡한 조명 효과까지 포착하여 새로운 시점에서의 이미지를 고품질로 생성할 수 있다.
  
- **암시적 3D 표현**  
  명시적인 3D 모델 대신 신경망 내부에 장면 정보를 암시적으로 저장하므로, 복잡한 지오메트리나 재질을 효율적으로 표현할 수 있다.

- **응용 분야**  
  가상현실, 증강현실, 영화 제작, 게임 등에서 3D 장면 재구성 및 새로운 시점의 이미지 합성에 활용된다.

---

## 한계점

- **연산 비용**  
  학습과 렌더링 과정에서 수많은 광선에 대해 여러 번의 함수 평가가 필요해 계산 비용이 매우 크다.
  
- **장면 특화**  
  보통 하나의 장면에 대해 모델을 따로 학습해야 하므로, 다양한 장면에 대해 실시간으로 적용하기에는 한계가 있다.
  
- **데이터 요구량**  
  고품질의 합성을 위해서는 다양한 시점에서 촬영된 이미지가 필요하며, 입력 데이터가 부족하면 성능이 떨어질 수 있다.

---

Neural Radiance Fields는 신경망을 이용해 장면의 모든 정보를 암시적으로 표현하고, 이를 기반으로 임의의 시점에서 현실적인 이미지를 생성하는 혁신적인 기술이다. 이 기술은 3D 재구성 및 새로운 시점의 이미지 합성 분야에서 많은 가능성을 보여주고 있으며, 앞으로의 연구와 응용에서 중요한 역할을 할 것으로 기대된다.

Dirichlet 경계 조건은 미분 방정식의 해를 구할 때 경계에서 함수의 값을 미리 정해주는 조건이다. 문제의 정의역 내부에서 해를 결정하는 미분 방정식과 함께, 경계에서 함수가 어떤 값을 가져야 하는지를 명시함으로써 해의 유일성이 보장되는 경우가 많다.

예를 들어, 구간 $$[a, b]$$에서 정의된 함수 $$u(x)$$에 대해 2계 미분 방정식  

$$ u''(x) = f(x) $$

를 풀 때, 경계 조건으로 $$u(a) = A$$와 $$u(b) = B$$를 주면, 이는 Dirichlet 경계 조건에 해당한다. 이 경우, 경계 $$\{a, b\}$$에서 $$u(x)$$의 값이 각각 $$A$$와 $$B$$로 고정되어 있다.

물리 문제에서 Dirichlet 조건은 고정된 온도, 고정된 전위, 혹은 고정된 변위와 같은 상황을 모델링할 때 사용된다. 예를 들어, 열 전도 문제에서 금속 막대의 양쪽 끝에 일정한 온도를 유지하도록 설정하면, 막대 내부의 온도 분포를 결정하는 데 Dirichlet 경계 조건이 사용된다.

이 조건은 해석적 해법이나 수치적 해법(예: 유한 요소법)에서 필수적인 역할을 하며, 경계 조건이 주어지면 해의 존재성과 유일성이 확보되는 경우가 많아 문제 해결에 큰 도움이 된다. Dirichlet 조건은 Neumann 조건(경계에서 미분값을 정하는 조건)과 대비되어 사용되며, 문제의 물리적 상황에 따라 적절한 조건을 선택하게 된다.

Neumann 경계 조건과 Dirichlet 경계 조건은 미분 방정식의 해를 구할 때 경계에서 주어지는 조건에 따라 서로 다른 정보를 제공한다. Dirichlet 경계 조건은 해 자체의 값을 경계에서 고정하는 반면, Neumann 경계 조건은 해의 미분 값, 즉 경계에서의 변화율이나 플럭스를 정해준다.

예를 들어, 구간 $$[a, b]$$에서 정의된 함수 $$u(x)$$에 대해 Dirichlet 조건은 $$u(a) = A$$와 $$u(b) = B$$처럼 경계에서 함수의 구체적인 값을 지정한다. 이 경우, 경계에서 함수가 어떤 값을 가지는지가 미리 정해져 있으므로, 해가 그 값들을 반드시 만족해야 한다.

반면 Neumann 조건은 경계에서 함수의 도함수, 보통 법선 방향의 도함수를 지정한다. 예를 들어, $$u'(a) = C$$와 $$u'(b) = D$$와 같이 설정하면, 경계에서의 변화율이나 유속이 정해지는 효과가 있다. 열전도 문제에서 Neumann 조건은 경계가 단열 상태임을 나타내거나, 전기 문제에서 전류의 흐름을 나타내는 데 쓰인다.

두 조건 모두 미분 방정식의 해의 존재성과 유일성을 확보하는 데 중요한 역할을 하지만, Dirichlet 조건은 경계에서의 값이 고정되어 있어 문제의 제어가 명확한 반면, Neumann 조건은 해의 전체 상수항에 대해 자유도가 생길 수 있으며, 이 경우 추가적인 조건(예를 들어 평균값 고정 조건)이 필요할 수 있다.

결국 Dirichlet 조건은 경계에서의 상태 자체를 결정하는 데, Neumann 조건은 경계에서의 변화 양상을 결정하는 데 사용된다.