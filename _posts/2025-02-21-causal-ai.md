---
layout: post
use_math: true
title: Causal-aware Reasoning
date: 2025-02-21
categories: [artificial intelligence]
tags: [machine learning]

---

# Causal-aware Reasoning

인과 관계 인지 추론(Causal-aware reasoning)은 AGI가 단순한 상관관계 분석을 넘어서 변수들 간의 인과적 메커니즘을 명시적으로 모델링함으로써, 개입(intervention)이나 반사실적(counterfactual) 상황에서의 결과를 예측할 수 있도록 하는 추론 체계이다. 이 접근법은 단순히 관측된 데이터 분포 \(P(Y|X)\)를 추정하는 것을 넘어, “만약 \(X\)에 대해 인위적 개입을 수행한다면”이라는 질문에 답할 수 있는 모델링을 포함한다.

---

## 1. 구조적 인과 모델(Structural Causal Models, SCM)

SCM에서는 각 변수 \(X\)가 그 원인 변수 집합 \(\text{Pa}(X)\)와 외생적 요인 \(U_X\)에 의해 결정된다고 가정한다. 이는 다음과 같이 표현된다.

\[
X = f(\text{Pa}(X), U_X)
\]

여기서 함수 \(f\)는 변수 간의 인과 관계를 나타내며, 외생적 요인 \(U_X\)는 모델 외부에서 주어지는 불확실성을 반영한다. 이러한 구조를 통해 인과 그래프가 구성되며, 변수들 간의 직접적·간접적 인과 경로가 명시된다.

---

## 2. 개입과 do-연산자

관측 분포 \(P(Y|X=x)\)는 \(X\)와 \(Y\) 사이의 통계적 상관관계를 나타내지만, 이는 \(X\)가 \(Y\)의 원인임을 보장하지 않는다. 인과 관계를 파악하기 위해서는 개입(intervention)을 고려해야 하며, 이를 위해 do-연산자 \(do(X=x)\)를 도입한다. 개입 후의 분포는 다음과 같이 정의된다.

\[
P(Y \mid do(X=x)) = \sum_{z} P(Y \mid X=x, Z=z)P(Z=z)
\]

여기서 \(Z\)는 \(X\)와 \(Y\) 사이에 존재하는 교란 변수(confounder)나 매개 변수(mediator)를 포함하는 변수 집합으로, 후방문(back-door) 경로를 차단하는 역할을 한다. 이 공식은 Pearl의 후방문 조정(back-door adjustment) 공식을 일반화한 것이다.

---

## 3. 구체적 예시: 로봇의 장애물 회피

AGI가 탑재된 로봇이 환경 내 장애물을 회피하는 상황을 고려한다. 로봇의 센서 입력 \(S\), 행동 \(A\), 그리고 결과 \(R\) 사이의 인과 관계는 아래와 같이 모델링할 수 있다.

1. **모델링**  
   센서 입력 \(S\)는 환경 상태를 반영하며, 로봇의 행동 \(A\)는 \(S\)와 내재된 제어 정책 \(\pi\)에 의해 결정된다. 결과 \(R\)는 행동 \(A\)와 환경 변수 \(E\)의 상호작용으로 결정된다.
   
   \[
   A = \pi(S, U_A)
   \]
   \[
   R = g(A, E, U_R)
   \]
   
   여기서 \(U_A\)와 \(U_R\)는 각각 행동 결정과 결과에 영향을 미치는 외생적 요인이다.

2. **개입 시나리오**  
   로봇의 정책을 평가할 때 “센서 입력 \(S\)에 특정 값을 강제로 주었을 때 \(R\)이 어떻게 변화하는가”를 알고자 할 수 있다. 이때 \(do(S=s_0)\)를 수행하여, 센서 입력 \(S\)를 \(s_0\)로 고정시킨 후 행동과 결과의 변화를 관찰한다. 인과적 효과는 다음과 같이 나타낼 수 있다.
   
   \[
   P(R \mid do(S=s_0)) = \sum_{a} P(R \mid A=a, S=s_0) \, P(A=a \mid do(S=s_0))
   \]
   
   이 식은 센서 입력 \(S\)에 개입한 후의 결과 분포를 계산하는데, \(P(A=a \mid do(S=s_0))\)는 로봇의 정책이 \(S=s_0\)일 때 선택하는 행동 분포를 의미한다.

3. **반사실적 추론**  
   로봇이 실제로 센서 입력 \(S=s_1\)를 받았을 때의 행동과 결과가 관측되었다고 하자. 반사실적 추론은 “만약 \(S\)가 \(s_0\)였더라면 결과 \(R\)은 어땠을까”라는 질문에 답한다. 이는 인과 모델 내에서 다음과 같이 표현된다.
   
   \[
   R_{S=s_0} = g\left(\pi(s_0, U_A), E, U_R\right)
   \]
   
   이와 같이 반사실적 추론은 실제 관측된 외생 요인 \(U_A, U_R\)를 유지한 채, 입력 변수만 변경하여 결과를 예측한다.

---

## 4. AGI에서의 의의

AGI 시스템이 인과 관계 인지 추론을 내재화함으로써 다음과 같은 이점을 얻는다.

- **개입 효과 예측:** 단순한 상관관계를 넘어, 특정 행동이나 입력에 대한 인과적 결과를 예측할 수 있다.
- **반사실적 사고:** “만약 ~였다면”이라는 반사실적 질문에 답할 수 있어, 보다 유연하고 적응력 있는 의사결정을 지원한다.
- **모델의 일반화:** 인과 구조를 학습함으로써, 환경 변화나 새로운 상황에서도 기존의 인과 메커니즘을 바탕으로 일반화된 추론을 수행할 수 있다.

이러한 특성은 AGI가 다양한 환경에서 스스로 학습하고 적응하며, 복잡한 문제 해결에 있어 인간 수준 이상의 유연성을 확보하는 데 필수적이다.

---

요약하면, 인과 관계 인지 추론은 AGI의 핵심 구성 요소로, 변수 간의 인과적 상호작용을 명시적으로 모델링하고 개입 및 반사실적 상황에서의 결과 예측을 가능하게 한다. 이는 구조적 인과 모델과 do-연산자를 기반으로 하며, 로봇의 장애물 회피와 같은 구체적 사례를 통해 그 유용성이 입증된다.